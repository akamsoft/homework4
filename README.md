# Домашнее задание к занятию 4 «Оркестрация группой Docker контейнеров на примере Docker Compose»  

**Задача 1**

Ответ:  

https://hub.docker.com/r/alexkam75/custom-nginx

**Задача 2**

2.1

![Alt text](2/2.1.jpg)

2.2

![Alt text](2/2.2.jpg)

2.3

![Alt text](2/2.3.jpg)

2.4

![Alt text](2/2.4.jpg)

**Задача 3**

3.1-3.2

![Alt text](3/3.1-3.2.jpg)

3.3

![Alt text](3/3.3.jpg)

Контейнер остановился, потому что docker attach подключает к главному процессу контейнера. Нажатие Ctrl‑C обычно отправляет сигнал прерывания (SIGINT) в этот процесс. Если главный процесс завершился то Docker остановил контейнер, так как контейнер живёт ровно пока живёт его PID 1.

3.4-3.5

![Alt text](3/3.4-3.5.jpg)

3.6-3.7

![Alt text](3/3.6-3.7.jpg)

3.8

![Alt text](3/3.8.jpg)
![Alt text](3/3.8.1.jpg)
![Alt text](3/3.8.2.jpg)

3.9

![Alt text](3/3.9.jpg)

3.10

![Alt text](3/3.10.jpg)

Проброс порта Docker устроен так: хостовый порт 8080 проброшен на порт контейнера 80 (типично 127.0.0.1:8080 -> 80/tcp).
Поменял nginx внутри контейнера с listen 80 на listen 81, то есть nginx больше не принимает соединения на 80, поэтому запросы на http://127.0.0.1:8080 (которые попадают в контейнер на 80) ломаются.
Порт-мэппинг остался прежним (8080→80), а сервис переехал на 81.

3.11

![Alt text](3/3.11.jpg)

3.12

![Alt text](3/3.12.jpg)

**Задача 4**

4.1

![Alt text](4/4.1.jpg)

4.2

![Alt text](4/4.2.jpg)

4.3-4.4

![Alt text](4/4.3-4.4.jpg)

4.5

![Alt text](4/4.5.jpg)

**Задача 5**

5.1

![Alt text](5/5.1.jpg)

Запустится файл compose.yaml, так как в новых версиях Docker Compose каноническим является именно этот файл. В отличие от старых версий, где по умолчанию использовался файл с именем docker-compose.yaml, в современных версиях Docker Compose поддерживает использование compose.yaml как стандартного имени для конфигурационных файлов. Это означает, что при выполнении команды docker compose up -d будет запущен сервис, описанный в compose.yaml, а не в docker-compose.yaml, если оба файла присутствуют в одной директории.

5.2

Содержимое файла compose.yaml

include:

  - docker-compose.yaml
  - 
services:

  portainer:
  
    network_mode: host
    
    image: portainer/portainer-ce:latest
    
    volumes:
    
      - /var/run/docker.sock:/var/run/docker.sock

![Alt text](5/5.2.jpg)

5.3

![Alt text](5/5.3.jpg)

5.4

![Alt text](5/5.4.jpg)

5.5


![Alt text](5/5.5.jpg)


5.6

![Alt text](5/5.6.jpg)

5.7

![Alt text](5/5.7.jpg)

Orphan контейнеры — это контейнеры, которые были запущены ранее для этого проекта (имели имя и метки, связанные с текущим compose.yaml), но больше не описаны в текущем файле конфигурации.

Файлы compose.yaml и docker-compose.yaml находится в паке: "5"
